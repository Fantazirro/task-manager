<div class="card select-task-message mx-auto" *ngIf="!currentTask && !isNewTask">
    <div class="card-body">Выберите задачу</div>
</div>

<div class="card" style="height: 100%;" *ngIf="currentTask && !isEditMode">
    <div class="card-header navbar">
        <h3>{{ currentTask.header }}</h3>
        <div class="d-flex justify-content-end gap-2">
            <button type="button" class="btn p-0" (click)="editModeOn()" tooltip="Редактировать">
                <svg width="30px" height="30px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M14 6L8 12V16H12L18 10M14 6L17 3L21 7L18 10M14 6L18 10M10 4L4 4L4 20L20 20V14" stroke="#7080BB" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg></button>
            <button type="button" class="btn async-disable p-0" (click)="showDeleteModal(deleteModal)" tooltip="Удалить">
                <svg width="30px" height="30px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M6 7V18C6 19.1046 6.89543 20 8 20H16C17.1046 20 18 19.1046 18 18V7M6 7H5M6 7H8M18 7H19M18 7H16M10 11V16M14 11V16M8 7V5C8 3.89543 8.89543 3 10 3H14C15.1046 3 16 3.89543 16 5V7M8 7H16" stroke="#AA0000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>
        </div>
    </div>
    <div class="card-body">
        <pre style="height: 94%;">{{ currentTask.description }}</pre>
        <div *ngIf="currentTask.deadline">
            <svg height="30px" width="30px" fill="#FF7700" version="1.1" id="_x32_" xmlns="http://www.w3.org/2000/svg"
                xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" xml:space="preserve">
                <g>
                    <path class="st0"
                        d="M190.5,213.96c-3.887,5.298-3.314,12.346,1.299,15.726l55.58,42.879l0.774,0.444l0.347,0.193
                    		c4.806,2.677,11.17,1.258,15.411-3.412l0.371-0.354l68.121-80.597c3.879-4.347,3.944-10.605,0.17-13.96
                    		c-3.782-3.363-9.984-2.556-13.847,1.79l-63.678,68.024l-49.161-34.235C201.29,207.073,194.395,208.645,190.5,213.96z" />
                    <path class="st0" d="M60.152,245.726c-0.249,3.371-0.314,6.806-0.314,10.234c0,3.5,0.064,6.871,0.314,10.242h40.694
                    		c-0.364-3.371-0.436-6.798-0.436-10.242c0-3.427,0.072-6.862,0.436-10.234H60.152z" />
                    <path class="st0" d="M165.419,82.016c-5.072,2.565-10.016,5.404-14.814,8.517l20.29,35.234l1.492-1.008
                    		c3.846-2.436,7.774-4.734,11.758-6.766l1.557-0.75L165.419,82.016z" />
                    <path class="st0"
                        d="M90.548,150.596c-3.112,4.799-5.952,9.734-8.516,14.807l35.234,20.282l8.524-14.798L90.548,150.596z" />
                    <path class="st0" d="M125.79,340.976l-1.024-1.492c-2.428-3.79-4.726-7.71-6.758-11.766l-0.814-1.548l-35.161,20.282
                    		c2.5,5.073,5.403,10.008,8.516,14.806L125.79,340.976z" />
                    <path class="st0" d="M172.387,387.097l-1.492-1.016l-20.29,35.241c4.798,3.113,9.742,6.016,14.814,8.589l20.283-35.234l-1.557-0.75
                    		C180.161,391.903,176.234,389.605,172.387,387.097z" />
                    <path class="st0"
                        d="M361.282,90.532c-4.798-3.113-9.678-5.952-14.734-8.517l-20.363,35.162l14.806,8.588L361.282,90.532z" />
                    <path class="st0" d="M266.209,100.838V60.201c-3.371-0.306-6.798-0.371-10.242-0.371c-3.428,0-6.855,0.064-10.234,0.371v40.637
                    		v0.428h20.476V100.838z" />
                    <path class="st0" d="M386.064,170.863l7.847,13.541l0.742,1.322l0.25-0.169l35.016-20.145c-2.564-5.121-5.451-9.992-8.588-14.783
                    		L386.064,170.863z" />
                    <path class="st0" d="M448.992,266.072c0.17,0.089,0.17,0.089,0.17,0.169h2.637c0.25-3.386,0.331-6.854,0.331-10.322
                    		c0-3.387-0.081-6.854-0.331-10.161h-25.186c0.331,0.249,0.662,0.58,0.992,0.83L448.992,266.072z" />
                    <path class="st0"
                        d="M256,0C114.54,0,0,114.54,0,256c0,141.379,114.54,255.919,256,256c15.282,0,30.306-1.403,44.847-3.96
                    		c-12.637-7.847-23.782-17.839-33.032-29.403c-3.887,0.249-7.847,0.33-11.815,0.33c-61.686-0.081-117.258-24.935-157.725-65.323
                    		C57.895,373.266,33.032,317.605,33.032,256c0-61.685,24.862-117.266,65.242-157.726C138.741,57.887,194.314,33.032,256,33.032
                    		c61.605,0,117.186,24.855,157.654,65.242c40.378,40.46,65.234,96.04,65.314,157.726c0,14.621-1.484,28.903-4.129,42.693
                    		c9.58,14.952,16.604,30.726,20.975,46.912C506.306,317.685,512,287.548,512,256C511.919,114.54,397.379,0,256,0z" />
                    <path class="st0" d="M412.702,268.621c-19.315-15.452-26.855-32.484-29.759-44.621c-2.33-9.718-1.105-10.774-1.105-10.774
                    		c-0.096-1.153-0.83-2.153-1.879-2.637c-1.064-0.508-2.29-0.396-3.242,0.266c0,0-3.742,0.807-9.838,6.726
                    		c-13.887,13.467-29.573,35.967-19.242,66.701c11.121,32.976,5.234,39.887-0.572,39.444c-7.532-0.589-8.694-5.226-7.492-19.686
                    		c1.403-16.887-13.92-31.323-13.92-31.323s-23.814,37.855-42.371,64.928c-10.968,15.992-16.226,36.338-16.226,54.887h-0.371
                    		c0,57.08,46.266,103.346,103.339,103.346c57.072,0,103.322-46.266,103.322-103.346C477.282,342.976,450.354,298.75,412.702,268.621
                    		z M370.209,466.782c-31.492,0-57.008-25.524-57.008-57.008c0-10.71,2.968-20.75,8.097-29.306
                    		c4.436,16.491,19.484,28.621,37.363,28.621c21.371,0,38.694-17.315,38.694-38.662c0-4.089-0.646-8.024-1.815-11.709
                    		c18.758,9.322,31.661,28.67,31.661,51.056C427.201,441.258,401.693,466.782,370.209,466.782z" />
                </g>
            </svg>
            <span style="margin-left: 10px;">{{ currentTask.deadline | date: 'dd.MM.yyyy' }}</span>
        </div>
    </div>
</div>

<form class="card" style="height: 100%;" [formGroup]="taskForm" (submit)="false" *ngIf="(currentTask || isNewTask) && isEditMode">
    <div class="card-header navbar">
        <input type="text" class="current-task-text form-control" maxlength="50" placeholder="Задача" formControlName="header">
        <div class="d-flex justify-content-end gap-2">
            <button type="button" class="btn p-0 async-disable" (click)="saveChanges()" tooltip="Сохранить">
                <svg fill="#008800" width="30px" height="30px" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path id="save" class="cls-1" d="M1522,360h-20a2,2,0,0,1-2-2V338a2,2,0,0,1,2-2h15v0.006a1.016,1.016,0,0,1,.77.283l5.91,5.911a1.017,1.017,0,0,1,.29.8H1524v15A2,2,0,0,1,1522,360Zm-15-2h10v-7h-10v7Zm8-20h-6v6h6v-6Zm7,5.477-5-5V344a2,2,0,0,1-2,2h-6a2,2,0,0,1-2-2v-6h-5v20h3v-7a2,2,0,0,1,2-2h10a2,2,0,0,1,2,2v7h3V343.477Z" transform="translate(-1500 -336)"/>
                </svg>
            </button>
            <button type="button" class="btn p-0" (click)="editModeOff()" tooltip="Отмена">
                <svg fill="#BB0000" height="30px" width="30px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 392.619 392.619" xml:space="preserve">
                    <g>
                        <path d="M310.724,0.929H81.896C36.738,0.929,0,37.667,0,82.825v226.969c0,45.158,36.738,81.896,81.896,81.896h228.828
                            c45.157,0,81.896-36.738,81.896-81.896V82.825C392.619,37.667,355.881,0.929,310.724,0.929z M362.619,309.794
                            c0,28.616-23.28,51.896-51.896,51.896H81.896C53.28,361.69,30,338.41,30,309.794V82.825c0-28.615,23.28-51.896,51.896-51.896
                            h228.828c28.615,0,51.896,23.28,51.896,51.896V309.794z"/>
                        <path d="M286.559,107.182c-5.839-5.877-15.336-5.908-21.214-0.069l-66.539,66.106l-66.572-66.572
                            c-5.857-5.858-15.355-5.858-21.213,0c-5.858,5.858-5.858,15.355,0,21.213l66.502,66.503l-65.968,65.539
                            c-5.877,5.839-5.907,15.336-0.069,21.213c2.933,2.952,6.786,4.428,10.642,4.428c3.822,0,7.646-1.452,10.572-4.359l66.037-65.608
                            l66.073,66.073c2.929,2.929,6.768,4.394,10.606,4.394c3.838,0,7.678-1.465,10.606-4.394c5.858-5.858,5.858-15.355,0-21.213
                            l-66.004-66.004l66.47-66.038C292.366,122.556,292.396,113.059,286.559,107.182z"/>
                    </g>
                </svg>
            </button>
        </div>
    </div>
    <div class="card-body">
        <textarea class="current-task-text" maxlength="2000" placeholder="Описание задачи" formControlName="description"></textarea>
        <input type="text" placeholder="Datepicker" class="form-control" formControlName="deadline" bsDatepicker
        [bsConfig]="{ adaptivePosition: true }"
        [placeholder]="'Дедлайн'">
    </div>
</form>

<ng-template #deleteModal>
    <div class="modal-header">
        <h4 class="modal-title pull-left">Удалить задачу</h4>
        <button type="button" class="btn-close close pull-right" aria-label="Close" (click)="deleteModalRef?.hide()">
        <span aria-hidden="true" class="visually-hidden">&times;</span>
      </button>
    </div>
    <div class="modal-body">
        <p>Вы действительно хотите удалить эту задачу?</p>
        <div class="d-flex gap-2">
            <button class="btn btn-primary" style="width: 60px;" (click)="deleteTask()">Да</button>
            <button class="btn btn-primary" style="width: 60px;" (click)="deleteModalRef?.hide()">Нет</button>
        </div>
    </div>
</ng-template>